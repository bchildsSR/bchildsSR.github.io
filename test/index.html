<style>
table, th, td {
    border: 1px solid black;
}
</style>

<body>
<table>
  <tr>
    <th>Current Category Page Data</th>
  </tr>
  <tr>
    <td>Page Type:</td>
    <td class="page_type"></td>
  </tr>
    <tr>
    <td>Items in Cart:</td>
    <td class="items_in_cart"></td>
  </tr>
  <tr>
    <td>Product details should be blank:</td>
    <td class="product_details"></td>
  </tr>
  <tr>
    <td>Minimum requirements met?</td>
    <td class="pass_fail"></td>
  </tr>
</table>

<form>
  <h4>Find Category Page Selectors</h4>
  <p>Page Type:</p>
  <input type="text" name="page_type">
  <p class="page_type_new"></p>
  <p>Items in Cart:</p>
  <input type="text" name="items_in_cart">
  <p class="items_in_cart_new"></p>
  <p>Test New Selectors:</p>
  <input type="submit" value="Validate">
</form>

<table>
  <tr>
    <th></th>
    <th>Saved Selectors</th>
    <th>Value</th>
    <th>Data Type</th>
  </tr>
  <tr>
    <td>Page Type:</td>
    <td class="page_type_selector"></td>
    <td class="page_type_value"></td>
    <td class="page_type_data_type"></td>
  </tr>
    <tr>
    <td>Items in Cart:</td>
    <td class="items_in_cart_selector"></td>
    <td class="items_in_cart_value"></td>
    <td class="items_in_cart_data_type"></td>
  </tr>
</table>

<script>
    document.querySelector('.page_type_selector').innerHTML = localStorage.getItem("page_type_selector")
    document.querySelector('.page_type_value').innerHTML = localStorage.getItem("page_type_value")
    document.querySelector('.page_type_data_type').innerHTML = localStorage.getItem("page_type_data_type")
    document.querySelector('.items_in_cart_selector').innerHTML = localStorage.getItem("items_in_cart_selector")
    document.querySelector('.items_in_cart_value').innerHTML = localStorage.getItem("items_in_cart_value")
    document.querySelector('.items_in_cart_data_type').innerHTML = localStorage.getItem("items_in_cart_data_type")

	rawData = "auth_token=&sr_browser_id=4e0908b5-24ca-452a-b321-83a09ce494f2&pik_session_id=a305d218-ed46-85b-4b61-a2655343568&retailer_code=WHBM&experiments=mso%3A2%2Cls_1%3A2&page_url=http%3A%2F%2Fpikmonitor.s-9.us%2Fdivs%2Fstaging%2FWHBM&page_title=WHBM+(Staging)&sku=&doc_id=&referrer=&page_id=1543868022003&utm_medium=null&utm_content=null&country=undefined&loyalty_id=undefined&customer_email=undefined&page_type=cart&cart_total=&cart_subtotal=38.94&cart_shipping=&cart_discount=&cart_gift_card=&cart_tax=&items_in_cart=".split('&'); //atob(sr_$.model.data).split('&')
    trackingObj = {};
    rawData.forEach((a)=> {i = a.split('='), trackingObj[i[0]] = i[1]});

    document.querySelector('.page_type').innerHTML = trackingObj["page_type"];
    document.querySelector('.items_in_cart').innerHTML = trackingObj["items_in_cart"];
    document.querySelector('.product_details').innerHTML = trackingObj["doc_id"] + ' ' + trackingObj["item_name"] + ' ' +trackingObj["item_price"];

    if (trackingObj["page_type"] === "category"
        && (trackingObj["doc_id"] === "" || trackingObj["doc_id"] === undefined)
		&& (trackingObj["item_name"] === "" || trackingObj["item_name"] === undefined)
		&& (trackingObj["item_price"] === "" || trackingObj["item_price"] === undefined)
		) {
            document.querySelector('.pass_fail').innerHTML = "TRUE";
	} else {
		document.querySelector('.pass_fail').innerHTML = "FALSE";
	}

	let page_type_selector = document.querySelector('[name="page_type"]');
	page_type_selector.addEventListener('keyup', (e) => {
		document.querySelector('.page_type_new').innerHTML = 
		`Value: ${document.querySelector(page_type_selector.value)
		&& document.querySelector(page_type_selector.value).innerText} 
		Data Type: ${typeof (document.querySelector(page_type_selector.value)
		&& document.querySelector(page_type_selector.value).innerText)}`;
	});

	let items_in_cart_selector = document.querySelector('[name="items_in_cart"]');
	items_in_cart_selector.addEventListener('keyup', (e) => {
		document.querySelector('.items_in_cart_new').innerHTML = 
		`Value: ${document.querySelector(items_in_cart_selector.value)
		&& document.querySelector(items_in_cart_selector.value).innerText} 
		Data Type: ${typeof (document.querySelector(items_in_cart_selector.value)
		&& document.querySelector(items_in_cart_selector.value).innerText)}`;
	});

	let validate = document.querySelector('[type="submit"]');

	validate.addEventListener('click', () => {
		if (items_in_cart_selector.value) {
			localStorage.setItem("items_in_cart_selector", items_in_cart_selector.value);
			localStorage.setItem("items_in_cart_value", document.querySelector(items_in_cart_selector.value).innerText);
			localStorage.setItem("items_in_cart_data_type", typeof document.querySelector(items_in_cart_selector.value).innerText);
		};
		if (page_type_selector.value) {
			localStorage.setItem("page_type_selector", page_type_selector.value);
			localStorage.setItem("page_type_value", document.querySelector(page_type_selector.value).innerText);
			localStorage.setItem("page_type_data_type", typeof document.querySelector(page_type_selector.value).innerText);
		};
	});
</script>
</body>
